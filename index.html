<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NonoSecret Pro ğŸ¤</title>
    <meta name="theme-color" id="themeColor" content="#0f0c29">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/5968/5968292.png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --p: #6c5ce7; --bg: #0f0c29; --card-bg: rgba(255, 255, 255, 0.08); }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: white; text-align: center; padding: 20px; margin: 0; transition: 0.5s; }
        .card { background: var(--card-bg); backdrop-filter: blur(12px); border-radius: 25px; padding: 25px; max-width: 420px; margin: 15px auto; border: 1px solid rgba(255,255,255,0.1); }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .side-menu { position: fixed; top: 0; right: -280px; width: 280px; height: 100%; background: #1a1a2e; transition: 0.3s; z-index: 1000; padding-top: 60px; text-align: right; box-shadow: -5px 0 15px rgba(0,0,0,0.5); }
        .side-menu a, .menu-item { padding: 15px 25px; text-decoration: none; font-size: 16px; color: white; display: block; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .menu-btn { position: fixed; top: 20px; right: 20px; font-size: 25px; cursor: pointer; z-index: 1001; background: var(--p); padding: 5px 12px; border-radius: 8px; }

        button { width: 100%; padding: 14px; border-radius: 12px; border: none; background: var(--p); color: white; font-weight: bold; cursor: pointer; font-family: 'Cairo'; margin-top: 10px; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 12px; border: none; font-family: 'Cairo'; outline: none; box-sizing: border-box; background: rgba(255,255,255,0.95); color: #333; }
        .msg-box { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin-top: 12px; text-align: right; border-right: 5px solid var(--p); }
    </style>
</head>
<body>

    <div class="menu-btn" onclick="toggleMenu()">â˜°</div>
    
    <div id="mySideMenu" class="side-menu">
        <a href="#" onclick="toggleMenu()" style="color: #ff7675;">âŒ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</a>
        <div class="menu-item" onclick="changeTheme()">ğŸ¨ ØªØºÙŠÙŠØ± Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
        <div class="menu-item" onclick="updatePassPrompt()">ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</div>
        <div class="menu-item" onclick="installApp()">ğŸ“² ØªØ«Ø¨ÙŠØª ÙƒÙ€ Ø£Ø¨Ù„ÙƒÙŠØ´Ù†</div>
        <hr style="opacity: 0.1;">
        <a href="https://noorabdelhalim77-rgb.github.io/NonoChat-/">ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </div>

    <div class="card">
        <h1>NonoSecret ğŸ¤</h1>
        
        <div id="sendArea" style="display:none;">
            <p id="target" style="font-weight:bold; color:#a29bfe;"></p>
            <textarea id="msg" placeholder="Ø§ÙƒØªØ¨ ØµØ±Ø§Ø­ØªÙƒ Ø§Ù„Ø³Ø±ÙŠØ© Ù‡Ù†Ø§..."></textarea>
            <button onclick="send()">Ø¥Ø±Ø³Ø§Ù„ ØµØ±Ø§Ø­Ø© ğŸš€</button>
        </div>

        <div id="setup">
            <h3 style="font-size: 16px;">Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯ âœ¨</h3>
            <input type="text" id="uName" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø§Ø³Ù…Ùƒ">
            <input type="password" id="uPass" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ø³Ø± Ù„Ù„ØµÙ†Ø¯ÙˆÙ‚">
            <button onclick="reg()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ Ø¨ÙŠ</button>
            <div id="linkBox" style="display:none; background:#fff; color:#333; padding:15px; border-radius:12px; margin-top:15px;">
                <span id="theLink" style="font-size:11px; word-break:break-all;"></span>
                <button style="background:#2d3436; margin-top:10px;" onclick="copyLink()">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ğŸ“‹</button>
            </div>
        </div>

        <div id="inbox" style="display:none;">
            <hr style="opacity:0.1; margin:20px 0;">
            <div id="lockArea">
                <p style="font-size: 13px;">Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ù…Ø­Ù…ÙŠ Ø¨ÙƒÙ„Ù…Ø© Ø³Ø± ğŸ”</p>
                <input type="password" id="checkPass" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„">
                <button onclick="unlockInbox()" style="background:#2ecc71;">ÙØªØ­ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</button>
            </div>
            <div id="listArea" style="display:none;">
                <h3 style="font-size: 18px;">ğŸ“¥ Ø§Ù„ÙˆØ§Ø±Ø¯</h3>
                <div id="list"></div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDFWvrDn9SVHga8KZEzgJomfzqwLXAwCdI",
            authDomain: "nonosecretchat.firebaseapp.com",
            projectId: "nonosecretchat",
            databaseURL: "https://nonosecretchat-default-rtdb.firebaseio.com/",
            appId: "1:829424619714:web:8069677332219804e3860d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function toggleMenu() {
            let menu = document.getElementById("mySideMenu");
            menu.style.right = menu.style.right === "0px" ? "-280px" : "0px";
        }

        // --- 1. Ù…ÙŠØ²Ø© ØªØºÙŠÙŠØ± Ø§Ù„Ø£Ù„ÙˆØ§Ù† ---
        let themes = [
            {bg: "#0f0c29", p: "#6c5ce7"},
            {bg: "#2d3436", p: "#fab1a0"},
            {bg: "#1e272e", p: "#00d8d6"},
            {bg: "#636e72", p: "#fdcb6e"}
        ];
        let currentTheme = 0;
        function changeTheme() {
            currentTheme = (currentTheme + 1) % themes.length;
            document.documentElement.style.setProperty('--bg', themes[currentTheme].bg);
            document.documentElement.style.setProperty('--p', themes[currentTheme].p);
            toggleMenu();
        }

        // --- 2. Ù…ÙŠØ²Ø© ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ---
        function updatePassPrompt() {
            if(document.getElementById('listArea').style.display === 'none') {
                return alert('ÙŠØ¬Ø¨ ÙØªØ­ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø¨ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ ØªØºÙŠÙŠØ±Ù‡Ø§!');
            }
            let newPass = prompt("Ø£Ø¯Ø®Ù„ÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:");
            if(newPass) {
                db.ref('box/' + u + '/config').update({ password: newPass });
                alert('ØªÙ… ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø¨Ù†Ø¬Ø§Ø­! ğŸ”‘');
            }
            toggleMenu();
        }

        // --- 3. Ù…ÙŠØ²Ø© ØªØ«Ø¨ÙŠØª Ø§Ù„Ø£Ø¨Ù„ÙƒÙŠØ´Ù† ---
        function installApp() {
            alert('Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: Ø§Ø¶ØºØ·ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø«Ù„Ø§Ø« Ù†Ù‚Ø§Ø· ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø«Ù… Ø§Ø®ØªØ§Ø±ÙŠ "Add to Home screen" Ø£Ùˆ "ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚" ğŸ“²');
            toggleMenu();
        }

        let u = new URLSearchParams(window.location.search).get('u');
        if(u) {
            document.getElementById('sendArea').style.display = 'block';
            document.getElementById('inbox').style.display = 'block';
            document.getElementById('target').innerText = "Ø£Ø±Ø³Ù„ ØµØ±Ø§Ø­Ø© Ù„Ù€ " + decodeURIComponent(u).split('_')[0];
            db.ref('box/' + u + '/messages').on('value', (s) => {
                let h = ""; s.forEach((c) => { h = `<div class="msg-box">${c.val().text}</div>` + h; });
                document.getElementById('list').innerHTML = h || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹";
            });
        }

        function reg() {
            let n = document.getElementById('uName').value;
            let p = document.getElementById('uPass').value;
            if(!n || !p) return alert('Ø§ÙƒØªØ¨ÙŠ Ø§Ù„Ø§Ø³Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±!');
            let id = Math.floor(Math.random() * 9000) + 1000;
            let userId = encodeURIComponent(n) + '_' + id;
            db.ref('box/' + userId + '/config').set({ password: p });
            document.getElementById('theLink').innerText = window.location.origin + window.location.pathname + '?u=' + userId;
            document.getElementById('linkBox').style.display = 'block';
        }

        function unlockInbox() {
            let pass = document.getElementById('checkPass').value;
            db.ref('box/' + u + '/config/password').once('value').then((s) => {
                if(s.val() === pass) {
                    document.getElementById('lockArea').style.display = 'none';
                    document.getElementById('listArea').style.display = 'block';
                } else { alert('Ø®Ø·Ø£ ÙÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±!'); }
            });
        }

        function copyLink() {
            navigator.clipboard.writeText(document.getElementById('theLink').innerText);
            alert('ØªÙ… Ø§Ù„Ù†Ø³Ø®! Ø§Ù†Ø´Ø±ÙŠÙ‡ Ø§Ù„Ø¢Ù† ğŸ¤');
        }

        function send() {
            let m = document.getElementById('msg').value;
            if(!m) return alert('Ø§ÙƒØªØ¨ÙŠ ØµØ±Ø§Ø­ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹!');
            db.ref('box/' + u + '/messages').push({ text: m });
            alert('ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­! ğŸš€');
            document.getElementById('msg').value = "";
        }
    </script>
</body>
</html>
