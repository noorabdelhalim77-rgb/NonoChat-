<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NonoSecret Pro ğŸ”’</title>
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/noorabdelhalim77-rgb/NonoChat-/main/logo.png">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/noorabdelhalim77-rgb/NonoChat-/main/logo.png">
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --p: #6c5ce7; --bg: #0f0c29; --card-bg: rgba(255, 255, 255, 0.08); }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: white; text-align: center; padding: 20px; margin: 0; transition: 0.5s; overflow-x: hidden; }
        .card { background: var(--card-bg); backdrop-filter: blur(12px); border-radius: 25px; padding: 25px; max-width: 420px; margin: 15px auto; border: 1px solid rgba(255,255,255,0.1); position: relative; z-index: 1; }
        .app-logo { width: 90px; height: 90px; border-radius: 22px; margin-bottom: 10px; border: 2px solid var(--p); }
        .side-menu { position: fixed; top: 0; right: -280px; width: 280px; height: 100%; background: #1a1a2e; transition: 0.3s; z-index: 1000; padding-top: 60px; text-align: right; box-shadow: -5px 0 15px rgba(0,0,0,0.5); }
        .side-menu a, .menu-item { padding: 15px 25px; text-decoration: none; font-size: 16px; color: white; display: block; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .menu-btn { position: fixed; top: 20px; right: 20px; font-size: 25px; cursor: pointer; z-index: 1001; background: var(--p); padding: 5px 12px; border-radius: 10px; }
        button { width: 100%; padding: 14px; border-radius: 12px; border: none; background: var(--p); color: white; font-weight: bold; cursor: pointer; font-family: 'Cairo'; margin-top: 10px; transition: 0.3s; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 12px; border: none; font-family: 'Cairo'; outline: none; box-sizing: border-box; background: rgba(255,255,255,0.95); color: #333; }
        .msg-box { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; margin-top: 12px; text-align: right; border-right: 5px solid var(--p); display: flex; justify-content: space-between; align-items: center; }
        .del-btn { background: #ff7675; color: white; border: none; padding: 6px 12px; border-radius: 8px; cursor: pointer; font-size: 12px; width: auto; }
        .badge { font-size: 12px; background: var(--p); padding: 2px 10px; border-radius: 20px; }
        .new-alert { animation: pulse 1s infinite; background: #e17055 !important; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.15); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div class="menu-btn" onclick="toggleMenu()">â˜°</div>
    
    <div id="mySideMenu" class="side-menu">
        <a href="#" onclick="toggleMenu()" style="color: #ff7675;">âŒ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</a>
        <div class="menu-item" onclick="changeTheme()">ğŸ¨ ØªØºÙŠÙŠØ± Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
        <div class="menu-item" onclick="updatePassPrompt()">ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</div>
        <div class="menu-item" onclick="alert('Ø§Ø¶ØºØ·ÙŠ Ø¹Ù„Ù‰ 3 Ù†Ù‚Ø· ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø«Ù… Add to Home screen ğŸ“²')">ğŸ“² ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</div>
        <hr style="opacity: 0.1;">
        <a href="https://noorabdelhalim77-rgb.github.io/NonoChat-/">ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </div>

    <div class="card">
        <img src="https://raw.githubusercontent.com/noorabdelhalim77-rgb/NonoChat-/main/logo.png" class="app-logo" onerror="this.src='https://cdn-icons-png.flaticon.com/512/5968/5968292.png'" alt="NonoSecret Logo">
        <h1>NonoSecret ğŸ”’</h1>
        
        <div id="sendArea" style="display:none;">
            <p id="target" style="font-weight:bold; color:#a29bfe;"></p>
            <textarea id="msg" placeholder="Ø§ÙƒØªØ¨ ØµØ±Ø§Ø­ØªÙƒ Ø§Ù„Ø³Ø±ÙŠØ© Ù‡Ù†Ø§..."></textarea>
            <button onclick="send()">Ø¥Ø±Ø³Ø§Ù„ ØµØ±Ø§Ø­Ø© ğŸš€</button>
        </div>

        <div id="setup">
            <h3 style="font-size: 16px;">Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯ âœ¨</h3>
            <input type="text" id="uName" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø§Ø³Ù…Ùƒ">
            <input type="password" id="uPass" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ø³Ø± Ù„Ù„ØµÙ†Ø¯ÙˆÙ‚">
            <button onclick="reg()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ Ø¨ÙŠ</button>
            <div id="linkBox" style="display:none; background:#fff; color:#333; padding:15px; border-radius:12px; margin-top:15px;">
                <span id="theLink" style="font-size:11px; word-break:break-all;"></span>
                <button style="background:#2d3436; margin-top:10px;" onclick="copyLink()">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ğŸ“‹</button>
            </div>
        </div>

        <div id="inbox" style="display:none;">
            <hr style="opacity:0.1; margin:20px 0;">
            <div id="lockArea">
                <p style="font-size: 13px;">Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ù…Ø­Ù…ÙŠ Ø¨ÙƒÙ„Ù…Ø© Ø³Ø± ğŸ”</p>
                <input type="password" id="checkPass" placeholder="Ø£Ø¯Ø®Ù„ÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„ÙØªØ­ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„">
                <button onclick="unlockInbox()" style="background:#2ecc71;">ÙØªØ­ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</button>
            </div>
            <div id="listArea" style="display:none;">
                <h3 style="font-size: 18px;">ğŸ“¥ Ø§Ù„ÙˆØ§Ø±Ø¯ <span class="badge" id="msgCount">0</span></h3>
                <div id="list"></div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDFWvrDn9SVHga8KZEzgJomfzqwLXAwCdI",
            authDomain: "nonosecretchat.firebaseapp.com",
            projectId: "nonosecretchat",
            databaseURL: "https://nonosecretchat-default-rtdb.firebaseio.com/",
            appId: "1:829424619714:web:8069677332219804e3860d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let u = new URLSearchParams(window.location.search).get('u');
        let currentCount = 0;

        function toggleMenu() {
            let menu = document.getElementById("mySideMenu");
            menu.style.right = menu.style.right === "0px" ? "-280px" : "0px";
        }

        if(u) {
            document.getElementById('sendArea').style.display = 'block';
            document.getElementById('inbox').style.display = 'block';
            document.getElementById('target').innerText = "Ø£Ø±Ø³Ù„ ØµØ±Ø§Ø­Ø© Ù„Ù€ " + decodeURIComponent(u).split('_')[0];
            
            db.ref('box/' + u + '/messages').on('value', (s) => {
                let h = ""; let count = 0;
                s.forEach((c) => { 
                    h = `<div class="msg-box"><span>${c.val().text}</span> <button class="del-btn" onclick="deleteMsg('${c.key}')">ğŸ—‘ï¸ Ø­Ø°Ù</button></div>` + h; 
                    count++;
                });
                if(count > currentCount && currentCount !== 0) {
                    document.getElementById('msgCount').classList.add('new-alert');
                    setTimeout(() => document.getElementById('msgCount').classList.remove('new-alert'), 3000);
                }
                currentCount = count;
                document.getElementById('list').innerHTML = h || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹";
                document.getElementById('msgCount').innerText = count;
            });
        }

        function deleteMsg(msgId) {
            if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ÙŠÙ† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ØµØ±Ø§Ø­Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ')) {
                db.ref('box/' + u + '/messages/' + msgId).remove();
            }
        }

        function changeTheme() {
            let themes = [{bg: "#0f0c29", p: "#6c5ce7"}, {bg: "#2d3436", p: "#fab1a0"}, {bg: "#1e272e", p: "#00d8d6"}];
            let t = themes[Math.floor(Math.random()*themes.length)];
            document.documentElement.style.setProperty('--bg', t.bg);
            document.documentElement.style.setProperty('--p', t.p);
            toggleMenu();
        }

        function updatePassPrompt() {
            if(document.getElementById('listArea').style.display === 'none') return alert('Ø§ÙØªØ­ÙŠ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø£ÙˆÙ„Ø§Ù‹!');
            let newP = prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:");
            if(newP) db.ref('box/' + u + '/config').update({ password: newP });
            toggleMenu();
        }

        function reg() {
            let n = document.getElementById('uName').value;
            let p = document.getElementById('uPass').value;
            if(!n || !p) return alert('Ø£ÙƒÙ…Ù„ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!');
            let userId = encodeURIComponent(n) + '_' + Math.floor(Math.random() * 9000);
            db.ref('box/' + userId + '/config').set({ password: p });
            document.getElementById('theLink').innerText = window.location.origin + window.location.pathname + '?u=' + userId;
            document.getElementById('linkBox').style.display = 'block';
        }

        function unlockInbox() {
            let pass = document.getElementById('checkPass').value;
            db.ref('box/' + u + '/config/password').once('value').then((s) => {
                if(s.val() === pass) {
                    document.getElementById('lockArea').style.display = 'none';
                    document.getElementById('listArea').style.display = 'block';
                } else { alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø·Ø£!'); }
            });
        }

        function copyLink() {
            navigator.clipboard.writeText(document.getElementById('theLink').innerText);
            alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·! ğŸ¤');
        }

        function send() {
            let m = document.getElementById('msg').value;
            if(!m) return alert('Ø§ÙƒØªØ¨ÙŠ ØµØ±Ø§Ø­ØªÙƒ!');
            db.ref('box/' + u + '/messages').push({ text: m });
            alert('ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„!');
            document.getElementById('msg').value = "";
        }
    </script>
</body>
</html>
